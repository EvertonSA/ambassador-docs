# This file should be placed in the folder for the version of the product that's meant to be documented. A `/release-notes` page will be automatically generated and populated at build time.
# Note that an entry needs to be added to the `doc-links.yml` file in order to surface the release notes in the table of contents.
#
# The YAML in this file should contain:
#
# changelog: An (optional) URL to the CHANGELOG for the product.
# items: An array of releases with the following attributes:
#     - version: The (optional) version number of the release, if applicable.
#     - date: The date of the release in the format YYYY-MM-DD.
#     - notes: An array of noteworthy changes included in the release, each having the following attributes:
#         - title: A short title of the noteworthy change.
#         - body: Two or three sentences describing the change and why it is noteworthy. This is in rich text format and may contain HTML elements.
#         - image: The URL of an image that visually represents the noteworthy change. This can be an absolute path or the name of the image file placed under the `ambassador-docs/public` folder starting with `./` (e.g., `./ambassador-example.png`).
#         - docs: The path to the documentation page where additional information can be found.
#         - type: The type of change, one of `bugfix`, `feature`, `security` or `change`.
#

changelog: https://github.com/telepresenceio/telepresence/blob/$branch$/CHANGELOG.md
items:
  - version: 2.3.2
    date: '2021-06-21'
    notes:
      - title: Outbound Connections
        body: "Outbound connections are now routed to intercepted agents which means that the connections originate from the agent from the clusters perspective."
        docs: reference/routing/#outbound
        type: feature
      - title: Inbound Connections
        body: "Inbound connections from an intercepted agent are now tunneled to the manager over the existing gRPC connection, instead of establishing a new connection to the manager for each inbound connection."
        docs: reference/routing/#inbound
        type: feature
      - title: Service Port Annotation
        body: "The mutator webhook for injecting traffic-agents will now recognize a service port annotation"
        image: ./telepresence-2.3.2-svcport-annotation.png
        docs: reference/cluster-config#service-port-annotation
        type: feature
      - title: Traffic-manager needs new RBAC permissions
        body: "The traffic-manager requires [RBAC permissions](reference/rbac) to list nodes, pods, and to create a dummy service."
        docs: reference/routing/#subnets
        type: change
      - title: No need for RBAC to list nodes
        body: "The client no longer needs [RBAC permissions](reference/rbac) to list the nodes in the cluster since that functionality has been moved to the traffic-manager."
        docs: reference/routing/#subnets
        type: bugfix
      - title: No need for RBAC to create service
        body: "The client no longer needs [RBAC permissions](reference/rbac) to create a service in order to determine the service subnet accurately."
        docs: reference/routing/#subnets
        type: bugfix
      - title: Able to find subnets
        body: "Telepresence will now find the pod CIDRs even if they are not listed in the nodes."
        image: ./telepresence-2.3.2-subnets.png
        docs: reference/routing/#subnets
        type: bugfix
      - title: Removal of covered subnets
        body: "Subnets covered by other subnets are now removed and thus never added to the virtual network interface."
        docs: reference/routing/#subnets
        type: bugfix
      - title: Removal of DNS config files on macOS
        body: "On a macOS, files generated under /etc/resolver as the result of using include-suffixes in the cluster config, are now properly removed on quit."
        docs: reference/routing/#mac-os-resolver
        type: bugfix
      - type: bugfix
        title: Race condition in shutdown
        body: >-
          When shutting down the user-daemon or root-daemon on the
          laptop, `telepresence quit` and related commands no longer
          return early before everything is fully shut down.  Now it
          can be counted on that by the time the command returns that
          all of the side-effects on the laptop have been cleaned up.
  - version: 2.3.1
    date: '2021-06-14'
    notes:
      - title: DNS Resolver Configuration
        body: "Telepresence now supports per-cluster configuration for custom dns behavior, which will enable users to determine which local + remote resolver to use and which suffixes should be ignored + included. These can be configured on a per-cluster basis."
        image: ./telepresence-2.3.1-dns.png
        docs: reference/config
        type: feature
      - title: AlsoProxy Configuration
        body: "Telepresence now supports also proxying user-specified subnets so that they can access external services only accessible to the cluster while connected to Telepresence. These can be configured on a per-cluster basis and each subnet is added to the TUN device so that requests are routed to the cluster for IPs that fall within that subnet."
        image: ./telepresence-2.3.1-alsoProxy.png
        docs: reference/config
        type: feature
      - title: Mutating Webhook for Injecting Traffic Agents
        body: "The Traffic Manager now contains a mutating webhook to automatically add an agent to pods that have the <code>telepresence.getambassador.io/traffic-agent: enabled</code> annotation.  This enables Telepresence to work well with GitOps CD platforms that rely on higher level kubernetes objects matching what is stored in git.  For workloads without the annotation, Telepresence will add the agent the way it has in the past"
        image: ./telepresence-2.3.1-inject.png
        docs: reference/rbac
        type: feature
      - title: Traffic Manager Connect Timeout
        body: "The trafficManagerConnect timeout default has changed from 20 seconds to 60 seconds, in order to facilitate the extended time it takes to apply everything needed for the mutator webhook."
        image: ./telepresence-2.3.1-trafficmanagerconnect.png
        docs: reference/config
        type: change
      - title: Fix for large file transfers
        body: "Fix a tun-device bug where sometimes large transfers from services on the cluster would hang indefinitely"
        image: ./telepresence-2.3.1-large-file-transfer.png
        docs: reference/tun-device
        type: bugfix
      - title: Brew Formula Changed
        body: "Now that the Telepresence rewrite is the main version of Telepresence, you can install it via Brew like so: <code>brew install datawire/blackbird/telepresence</code>."
        image: ./telepresence-2.3.1-brew.png
        docs: install/index/
        type: change
  - version: 2.3.0
    date: '2021-06-01'
    notes:
      - title: Brew install Telepresence
        body: "Telepresence can now be installed via brew on macOS, which makes it easier for users to stay up-to-date with the latest telepresence version. To install via brew, you can use the following command: <code>brew install datawire/blackbird/telepresence2</code>."
        image: ./telepresence-2.3.0-homebrew.png
        docs: install/index/
        type: feature
      - title: TCP and UDP routing via Virtual Network Interface
        body: "Telepresence will now perform routing of outbound TCP and UDP traffic via a Virtual Network Interface (VIF). The VIF is a layer 3 TUN-device that exists while Telepresence is connected. It makes the subnets in the cluster available to the workstation and will also route DNS requests to the cluster and forward them to intercepted pods. This means that pods with custom DNS configuration will work as expected. Prior versions of Telepresence would use firewall rules and were only capable of routing TCP."
        image: ./tunnel.jpg
        docs: reference/tun-device
        type: feature
      - title: SSH is no longer used
        body: "All traffic between the client and the cluster is now tunneled via the traffic manager gRPC API. This means that Telepresence no longer uses ssh tunnels and that the manager no longer have an <code>sshd</code> installed. Volume mounts are still established using <code>sshfs</code> but it is now configured to communicate using the sftp-protocol directly, which means that the traffic agent also runs without <code>sshd</code>. A desired side effect of this is that the manager and agent containers no longer need a special user configuration."
        image: ./no-ssh.png
        docs: reference/tun-device/#no-ssh-required
        type: change
      - title: Running in a Docker container
        body: "Telepresence can now be run inside a Docker container. This can be useful for avoiding side effects on a workstation's network, establishing multiple sessions with the traffic manager, or working with different clusters simultaneously."
        image: ./run-tp-in-docker.png
        docs: reference/inside-container
        type: feature
      - title: Configurable Log Levels
        body: "Telepresence now supports configuring the log level for Root Daemon and User Daemon logs. This provides control over the nature and volume of information that Telepresence generates in <code>daemon.log</code> and <code>connector.log</code>."
        image: ./telepresence-2.3.0-loglevels.png
        docs: reference/config/#log-levels
        type: feature
  - version: 2.2.2
    date: '2021-05-17'
    notes:
      - title: Legacy Telepresence subcommands
        body: Telepresence is now able to translate common legacy Telepresence commands into native Telepresence commands. So if you want to get started quickly, you can just use the same legacy Telepresence commands you are used to with the new Telepresence binary.
        image: ./telepresence-2.2.png
        docs: install/migrate-from-legacy/
        type: feature
