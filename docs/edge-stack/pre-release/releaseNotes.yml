# This file should be placed in the folder for the version of the product that's meant to be documented. A `/release-notes` page will be automatically generated and populated at build time.
# Note that an entry needs to be added to the `doc-links.yml` file in order to surface the release notes in the table of contents.
#
# The YAML in this file should contain:
#
# changelog: An (optional) URL to the CHANGELOG for the product.
# items: An array of releases with the following attributes:
#     - version: The (optional) version number of the release, if applicable.
#     - date: The date of the release in the format YYYY-MM-DD.
#     - notes: An array of noteworthy changes included in the release, each having the following attributes:
#         - title: A short title of the noteworthy change.
#         - body: Two or three sentences describing the change and why it is noteworthy. This is in rich text format and may contain HTML elements.
#         - image: The URL of an image that visually represents the noteworthy change. This can be an absolute path or the name of the image file placed under the `ambassador-docs/public` folder starting with `./` (e.g., `./ambassador-example.png`).
#         - docs: The path to the documentation page where additional information can be found.
#         - type: The type of change, one of `bugfix`, `feature`, `security` or `change`.
#

changelog: https://github.com/emissary-ingress/emissary/blob/$branch$/CHANGELOG.md
items:
  - version: 2.0.0-ea
    date: '2021-06-14'
    notes:
      - title: The <code>Listener</code> Resource
        body: TODO NEEDS WORK The <code>Listener</code> CRD allows explicit definition of ports to listen on, and the protocols and security model for each port
        type: feature
      - title: "Fix Host CRD insecure request actions"
        body: "<code>requestPolicy.insecure.action</code> field now works independently across multiple <code>Host</code> CRDs"
        docs: topics/running/host-crd/#secure-and-insecure-requests
        image: ./edge-stack-2.0.0-insecure_action_hosts.png
        type: bugfix
      - title: Correctly set Ingress resource status in all cases
        body: "Fixed a regression in detecting the Ambassador Kubernetes service that could cause the wrong IP or hostname to be used in Ingress statuses."
        docs: topics/running/ingress-controller
        type: bugfix
        image: ./edge-stack-2.0.0-ingressstatus.png
      - title: Deprecate <code>tls</code> field on the Ambassador module
        body: "The <code>tls</code> field on the Ambassador module is now deprecated. Please use <code>TLSContext</code> resources instead."
        docs: topics/running/tls/#tlscontext
        image: ./edge-stack-2.0.0-tlscontext.png
        type: change
      - title: Envoy V3 APIs
        body: "Envoy V3 API is the new default for Emissary"
        type: change
        docs: https://www.envoyproxy.io/docs/envoy/latest/api-v3/api
      - title: Host now required for TLS termination
        body: The <code>Host</code> CRD is now required when terminating TLS.
        docs: topics/running/host-crd
        type: change
        image: ./edge-stack-2.0.0-host_crd.png
      - title: Service Preview is deprecated
        body: Service Preview has been deprecated in Emissary. Please use Telepresence instead.
        docs: https://www.getambassador.io/docs/telepresence
        type: change
      - title: Deprecate redirect_cleartext_from field in TLSContext
        body: The field <code>redirect_cleartext_from</code> in a <code>TLSContext</code> is no longer supported -- use an extra 'Listener' instead!
        type: change
        #image: TODO
        #docs: TODO
      - title: Memory usage improvements for installations with many <code>Host</code>s
        body: Ambassador Module <code>prune_unreachable_routes</code> now defaults to true, which should reduce Envoy memory requirements for installations with many <code>Host</code>s
        docs: topics/running/ambassador/#prune-unreachable-routes
        image: ./edge-stack-2.0.0-prune_routes.png
        type: feature
      - title: Deprecation and Removal of <code>edgectl</code>
        body: "Deprecated and removed edgectl binary, as this was effectively a wrapper over helm. Please use the <code>emissary-ingress</code> helm chart to install emissary instead."
        type: change
        docs: "topics/install/helm/"
      - title: Higher performance while generating envoy configuration now enabled by default
        body: The environment variable <code>AMBASSADOR_FAST_RECONFIGURE</code> is a feature flag that enables a higher performance implementation of the code Ambassador uses to validate and generate envoy configuration, and is now enabled by default.
        docs: topics/running/scaling/#ambassador_fast_reconfigure-and-ambassador_legacy_mode-flags
        type: change
      - title: Edge Policy Console has been removed
        body: Edge Stack's Edge Policy Console has now been removed.
        type: change
      - title: Removed Ambassador <code>Project</code> functionality
        body: We have removed support for <code>Project</code>s in Emissary
        type: change
        docs: topics/using/projects

  - version: 1.13.8
    date: '2021-06-08'
    notes:
      - title: Fix Ambassador Cloud Service Details
        body: "Fixed a bug that occasionally caused missing version information for a service in the Ambassador Service Catalog, especially in clusters with high pod churn."
        type: bugfix
        docs: tutorials/getting-started/#3-connect-your-cluster-to-ambassador-cloud
        image: ./edge-stack-1.13.8-cloud-bugfix.png
      - title: Improved Argo Rollouts Experience with Ambassador Cloud
        body: "Ambassador Agent now reports the state of ArgoCD configurations and Deployments in order to provide proper configurations to the users while setting up the Argo Rollouts feature."
        type: feature
        docs: https://www.getambassador.io/docs/argo

  - version: 1.13.7
    date: '2021-06-03'
    notes:
      - title: Ambassador JSON logging support
        body: "An <code>AMBASSADOR_JSON_LOGGING</code> environment variable has been added. When set to <code>true</code> JSON format will be used for most of the control plane logs. Some (but few) logs from <code>gunicorn</code> and the Kubernetes <code>client-go</code> package will still be in text only format."
        image: ./edge-stack-1.13.7-json-logging.png
        docs: topics/running/running/#log-format
        type: feature
      - title: Consul resolver bugfix with TCPMappings
        body: "The TCPMapping has the ability to specify a resolver, however the <code>ConsulResolver</code> did not work properly with it. It now utilizes the Consul Connect service discovery instead of falling back to attempting to register an arbitrary endpoint."
        image: ./edge-stack-1.13.7-tcpmapping-consul.png
        docs: topics/running/resolvers/#the-consul-resolver
        type: bugfix
      - title: Memory usage calculation improvements
        body: "The internal memory usage calculation that Emissary Ingress and Ambassador Edge Stack perform has been updated to exclude cache memory. This now matches how the kernel OOMKiller calculates memory and should avoid situations where Envoy updates are throttled unnecessarily."
        image: ./edge-stack-1.13.7-memory.png
        docs: topics/running/scaling/#inspecting-ambassador-performance
        type: change
  - version: 1.13.4
    date: '2021-05-13'
    notes:
      - title: Envoy 1.15.5
        body: Emissary Ingress 1.13.4 and Edge Stack 1.13.4 have been updated to Envoy 1.15.5, which addresses a high severity security vulnerability (CVE-2021-29492). Edge Stack and Emissary Ingress can now be configured to reject client requests that contain escaped slashes.
        image: ./edge-stack-1.13.4.png
        docs: topics/running/ambassador/#rejecting-client-requests-with-escaped-slashes
        type: security
